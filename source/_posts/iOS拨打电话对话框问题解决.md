---
title: iOS拨打电话对话框问题解决
date: 2017-09-28 22:14:20
tags: [打电话, 蓝牙, PBAP]
categories: [小飞鱼]
---

`iOS`中拨打电话大家应该都很清楚了，如果还有什么疑问的话可以参考[这篇文章](https://historyzhang.github.io/2014/09/05/iOS%E6%8B%A8%E6%89%93%E7%94%B5%E8%AF%9D/)。但是`iOS10`的系统会先有个对话框确认，这与并不符合小飞鱼的需求。小飞鱼是由语音控制拨打电话，当用户查找到号码后，只需语音确认一次即可拨打电话，如果有系统的确认对话框，不仅多了一个步骤，而且还需要模拟点击对话框按钮事件，比较繁琐。
<!--more-->
由于小飞鱼中，`App`和设备之间是通过`BLE`和传统蓝牙来连接的，而用过蓝牙耳机的都应该知道，可以之间通过蓝牙耳机拨打电话。所以方案就有了：
![小飞鱼打电话方案](http://upload-images.jianshu.io/upload_images/606479-40f070fe687c0735.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)
如上图，`App`端先通过`BLE`把号码发送给设备，然后设备通过传统蓝牙协议(`PBAP`中`AT Command`)，直接拨号即可，不会弹出确认框。

具体的指令如下：`AT#CW13012341234\r\n`；
整个`PBAP`协议参见[这篇文章](http://file.yizimg.com/440517/2015090120595853.pdf)
